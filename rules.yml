groups:
  - name: network-alerts
    rules:
      # Recording rule: device_up = 1 if Prometheus can scrape SNMP
      - record: device_up
        expr: up{job="test-monitor-ubuntu"} == 1
        labels:
          device_group: "network-devices"

      # Device down alert
      - alert: DeviceDown
        expr: device_up{device_group="network-devices"} == 0
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "Device {{ $labels.instance }} is down"
          description: "Prometheus cannot scrape SNMP metrics from {{ $labels.instance }} for more than 2 minutes."

      # Device recovered alert
      - alert: DeviceRecovered
        expr: device_up{device_group="network-devices"} == 1
        for: 0m
        labels:
          severity: info
        annotations:
          summary: "Device {{ $labels.instance }} has recovered"
          description: "Prometheus is successfully scraping SNMP metrics from {{ $labels.instance }} again."

      # Interface throughput drop
      - alert: InterfaceThroughputDrop
        expr: sum by (instance, ifDescr) (rate(ifHCInOctets{job="test-monitor-ubuntu"}[5m])) < 1024
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Low inbound throughput on {{ $labels.instance }} / {{ $labels.ifDescr }}"
          description: "Inbound throughput dropped below threshold (1 KB/s) for 5 minutes."

 
